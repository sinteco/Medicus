{"version":3,"sources":["containers/appointments/appointment/views/detailView/reports/addSection.js","containers/appointments/appointment/views/detailView/reports/listSection.js","containers/appointments/appointment/views/detailView/reports/index.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/iterableToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js"],"names":["AddSection","props","useState","errorMessage","setErrorMessage","name","fields","setFields","e","a","target","value","preventDefault","newReport","fromUsername","Username","user","session","replace","date","Date","fetch","appointment","id","method","credentials","headers","authToken","body","JSON","stringify","response","json","data","ok","Error","message","appendReport","console","error","className","handleSubmit","role","type","onChange","required","for","DefaultReportItem","ReportItem","handleDelete","report","fromCurrentUser","handleClick","ListSection","reports","length","map","index","deleteReport","ReportSection","limit","state","setState","url","searchParams","URLSearchParams","append","Math","ceil","toString","newReports","prevState","updatedReports","filter","title","expandIcon","collapseIcon","callback","_toConsumableArray","arr","Array","isArray","arrayLikeToArray","iter","Symbol","iterator","Object","from","unsupportedIterableToArray","TypeError"],"mappings":"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","file":"static/js/21.ec65bf95.chunk.js","sourcesContent":["import React, { useState } from 'react';\r\nimport { Form, FormGroup, FormRow, \r\n    FormSubmit } from '../../../../../../components/form';\r\nimport { Username } from '../../../../../../components/users';\r\n\r\n\r\nexport default function AddSection(props) {\r\n    const [errorMessage, setErrorMessage] = useState(\"\");\r\n    const [fields, setFields] = useState({\r\n        name: \"\"\r\n    });\r\n\r\n    async function handleChange(e) {\r\n        setFields({\r\n            ...fields,\r\n            [e.target.name]: e.target.value\r\n        });\r\n    }\r\n\r\n    async function handleSubmit(e) {\r\n        e.preventDefault();\r\n        try {\r\n            const newReport = {\r\n                fromUsername: Username({ user: props.session }),\r\n                name: fields.name.replace(/^.*[\\\\\\/]/, ''),\r\n                date: new Date()\r\n            };\r\n\r\n            const response = await fetch(`/api/appointments/${props.appointment.id}/labReports`, {\r\n                method: 'POST',\r\n                credentials: 'same-origin',\r\n                headers: {\r\n                  'Content-Type': 'application/json',\r\n                  'Authorization': `Bearer ${props.session.authToken}`\r\n                },\r\n                body: JSON.stringify(newReport)\r\n            });\r\n\r\n            let data = await response.json();\r\n            if (!response.ok) {\r\n                throw new Error(data.message);\r\n            }\r\n\r\n            newReport.id = data.id;\r\n            if (props.appendReport) {\r\n                props.appendReport(newReport);\r\n            }\r\n\r\n            setFields({\r\n                ...fields,\r\n                name: \"\"\r\n            });\r\n        } catch (err) {\r\n            console.error(`Failed to add new report. ${err}`);\r\n            setErrorMessage(err.message);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <Form className=\"container-fluid\" handleSubmit={handleSubmit}>\r\n            {(errorMessage) &&\r\n                <FormRow className=\"justify-content-center\">\r\n                    <div className=\"alert alert-danger\" role=\"alert\">{errorMessage}</div>\r\n                </FormRow>\r\n            }\r\n            <FormRow className=\"my-2\">\r\n                <FormGroup className=\"custom-file\">\r\n                  <input id=\"reportsForm01\" type=\"file\" name=\"name\" className=\"custom-file-input\"\r\n                    value={fields.name} onChange={handleChange} required />\r\n                  <label className=\"custom-file-label\" for=\"reportsForm01\">\r\n                    {\r\n                      (fields.name) ? fields.name.replace(/^.*[\\\\\\/]/, '') : \"Choose a file...\"\r\n                    }\r\n                  </label>\r\n                </FormGroup>\r\n            </FormRow>\r\n            <FormRow className=\"my-2 justify-content-center\">\r\n                <FormSubmit className=\"col-auto col-md-4\">Upload</FormSubmit>\r\n            </FormRow>\r\n        </Form>\r\n    );\r\n}","import React from 'react';\r\nimport { NumericDate } from '../../../../../../components/dates';\r\nimport { Col, FluidContainer, Row } from '../../../../../../components/layout';\r\nimport { Username } from '../../../../../../components/users';\r\nimport { WidgetList, WidgetListItem, WidgetDropdown, \r\n    WidgetDropdownItem } from '../../../../../../components/widgets';\r\n\r\n\r\nfunction DefaultReportItem(props) {\r\n    return (\r\n        <WidgetListItem>\r\n            <FluidContainer>\r\n                <Row>\r\n                    <Col className=\"md-font-sm text-center text-muted\">No report available</Col>\r\n                </Row>\r\n            </FluidContainer>\r\n        </WidgetListItem>\r\n    );\r\n}\r\n\r\n\r\nfunction ReportItem(props) {\r\n    async function handleDelete(e) {\r\n        e.preventDefault();\r\n        if (props.handleDelete) {\r\n            props.handleDelete(props.report.id);\r\n        }\r\n    }\r\n\r\n    const fromUsername = props.report.fromUsername;\r\n    const currentUsername = Username({ user: props.session });\r\n    const fromCurrentUser = (currentUsername === fromUsername) ? true: false;\r\n\r\n    const date = new Date(props.report.date);\r\n    return (\r\n        <WidgetListItem>\r\n            <FluidContainer>\r\n                <Row>\r\n                    <Col className=\"align-self-center\">\r\n                        <Row>\r\n                            <Col className=\"text-truncate\">{props.report.name}</Col>\r\n                            <Col className=\"col-auto\">\r\n                                <NumericDate date={date} />\r\n                            </Col>\r\n                        </Row>\r\n                    </Col>\r\n                    <Col className=\"col-auto px-2\">\r\n                        {fromCurrentUser &&\r\n                            <WidgetDropdown>\r\n                                <WidgetDropdownItem handleClick={handleDelete}>Delete</WidgetDropdownItem>\r\n                            </WidgetDropdown>\r\n                        }\r\n                    </Col>\r\n                </Row>\r\n            </FluidContainer>\r\n        </WidgetListItem>\r\n    );\r\n}\r\n\r\n\r\nexport default function ListSection(props) {\r\n    return (\r\n        <WidgetList>\r\n            {(props.reports.length !== 0) ?\r\n                <>\r\n                    {props.reports.map((report, index) => (\r\n                        <ReportItem \r\n                            key={index}\r\n                            session={props.session}\r\n                            report={report}\r\n                            handleDelete={props.deleteReport}\r\n                        />\r\n                    ))}\r\n                </> :\r\n                <DefaultReportItem />\r\n            }\r\n        </WidgetList>\r\n    );\r\n}","import React, { useState } from 'react';\r\nimport { AutoLoader } from '../../../../../../components/loaders';\r\nimport { TitleBar, TitleToggler, Widget, \r\n    WidgetCollapsible } from '../../../../../../components/widgets';\r\n\r\nimport AddSection from './addSection';\r\nimport ListSection from './listSection';\r\n\r\n\r\nexport default function ReportSection(props) {\r\n    const [state, setState] = useState({\r\n        reports: [],\r\n        limit: 10\r\n    });\r\n\r\n    async function appendReports() {\r\n        try {\r\n            const url = `/api/appointments/${props.appointment.id}/labReports`;\r\n\r\n            const searchParams = new URLSearchParams();\r\n            searchParams.append('page', Math.ceil(state.reports.length / state.limit));\r\n            searchParams.append('limit', state.limit);\r\n\r\n            const response = await fetch(`${url}?${searchParams.toString()}`, {\r\n                headers: {\r\n                    'Authorization': `Bearer ${props.session.authToken}`\r\n                }\r\n            });\r\n\r\n            let newReports = await response.json();\r\n            if (!response.ok) {\r\n                throw new Error(newReports.message);\r\n            }\r\n\r\n            setState(prevState => {\r\n                const updatedReports = [...prevState.reports, ...newReports];\r\n\r\n                return {\r\n                    ...prevState,\r\n                    reports: updatedReports\r\n                }\r\n            })\r\n        } catch (err) {\r\n            console.error(`Failed to append more reports. ${err}`);\r\n        }\r\n    }\r\n\r\n    async function appendReport(newReport) {\r\n        setState(prevState => {\r\n            const newReports = [newReport, ...prevState.reports];\r\n\r\n            return {\r\n                ...prevState,\r\n                reports: newReports\r\n            }\r\n        });\r\n    }\r\n\r\n    async function deleteReport(id) {\r\n        try {\r\n            const response = await fetch(`/api/appointments/${props.appointment.id}/labReports/${id}`, {\r\n                method: 'DELETE',\r\n                credentials: 'same-origin',\r\n                headers: {\r\n                  'Content-Type': 'application/json',\r\n                  'Authorization': `Bearer ${props.session.authToken}`\r\n                }\r\n            });\r\n\r\n            let data = await response.json();\r\n            if (!response.ok) {\r\n                throw new Error(data.message);\r\n            }\r\n\r\n            setState(prevState => {\r\n                const newReports = state.reports.filter(report => {\r\n                    return report.id !== id;\r\n                });\r\n\r\n                return {\r\n                    ...prevState,\r\n                    reports: newReports\r\n                }\r\n            });\r\n        } catch (err) {\r\n            console.error(`Failed to delete report- ${id}. ${err}`);\r\n        }\r\n    }\r\n    return (\r\n        <>\r\n            <Widget>\r\n                <TitleBar title=\"Reports\">\r\n                    <TitleToggler \r\n                        target=\"apptReportAdd01\"\r\n                        expandIcon=\"add\"\r\n                        collapseIcon=\"clear\"\r\n                    />\r\n                </TitleBar>\r\n                <WidgetCollapsible id=\"apptReportAdd01\">\r\n                    <AddSection\r\n                        session={props.session}\r\n                        appointment={props.appointment}\r\n                        appendReport={appendReport}\r\n                    />\r\n                </WidgetCollapsible>\r\n                <ListSection\r\n                    session={props.session}\r\n                    reports={state.reports}\r\n                    deleteReport={deleteReport}\r\n                />\r\n            </Widget>\r\n            <AutoLoader callback={appendReports} />\r\n        </>\r\n    );\r\n}","import arrayWithoutHoles from \"@babel/runtime/helpers/esm/arrayWithoutHoles\";\nimport iterableToArray from \"@babel/runtime/helpers/esm/iterableToArray\";\nimport unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nimport nonIterableSpread from \"@babel/runtime/helpers/esm/nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"@babel/runtime/helpers/esm/arrayLikeToArray\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}"],"sourceRoot":""}