{"version":3,"sources":["containers/appointments/appointment/views/detailView/payments/addSection.js","containers/appointments/appointment/views/detailView/payments/infoSection.js","containers/appointments/appointment/views/detailView/payments/listSection.js","containers/appointments/appointment/views/detailView/payments/index.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/iterableToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js"],"names":["AddSection","props","useState","errorMessage","setErrorMessage","amount","fields","setFields","e","a","target","name","value","preventDefault","appointment","paymentBalance","Error","newPayment","fromUsername","Username","user","session","toUsername","physician","date","Date","fetch","id","method","credentials","headers","authToken","body","JSON","stringify","response","json","data","ok","message","appendPayment","console","error","className","handleSubmit","role","for","type","onChange","placeholder","min","step","InfoSection","serviceCharge","DefaultPaymentItem","PaymentItem","payment","ListSection","payments","length","map","index","handleDelete","deletePayment","PaymentSection","limit","state","setState","url","searchParams","URLSearchParams","append","Math","ceil","toString","newPayments","prevState","updatedPayments","updatePayment","newPaymentBalance","deletedPayment","filter","Object","assign","isCurrentUserPatient","useCompareUsers","patient","title","expandIcon","collapseIcon","callback","_toConsumableArray","arr","Array","isArray","arrayLikeToArray","iter","Symbol","iterator","from","unsupportedIterableToArray","TypeError"],"mappings":"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","file":"static/js/20.3f8c80da.chunk.js","sourcesContent":["import React, { useState } from 'react';\r\nimport { Form, FormGroup, FormLabel, FormRow, \r\n    FormSubmit } from '../../../../../../components/form';\r\nimport { Username } from '../../../../../../components/users';\r\n\r\n\r\nexport default function AddSection(props) {\r\n    const [errorMessage, setErrorMessage] = useState(\"\");\r\n    const [fields, setFields] = useState({\r\n        amount: \"\"\r\n    });\r\n\r\n    async function handleChange(e) {\r\n        setFields({\r\n            ...fields,\r\n            [e.target.name]: e.target.value\r\n        });\r\n    }\r\n\r\n    async function handleSubmit(e) {\r\n        e.preventDefault();\r\n        try {\r\n            if (fields.amount > props.appointment.paymentBalance) {\r\n                throw new Error(\"Payment amount cannot be more than balance.\")\r\n            }\r\n\r\n            const newPayment = {\r\n                fromUsername: Username({ user: props.session }),\r\n                toUsername: Username({ user: props.appointment.physician}),\r\n                amount: fields.amount,\r\n                date: new Date()\r\n            };\r\n\r\n            const response = await fetch(`/api/appointments/${props.appointment.id}/payments`, {\r\n                method: 'POST',\r\n                credentials: 'same-origin',\r\n                headers: {\r\n                  'Content-Type': 'application/json',\r\n                  'Authorization': `Bearer ${props.session.authToken}`\r\n                },\r\n                body: JSON.stringify(newPayment)\r\n            });\r\n\r\n            let data = await response.json();\r\n            if (!response.ok) {\r\n                throw new Error(data.message);\r\n            }\r\n\r\n            newPayment.id = data.id;\r\n            if (props.appendPayment) {\r\n                props.appendPayment(newPayment);\r\n            }\r\n\r\n            setFields({\r\n                ...fields,\r\n                amount: \"\"\r\n            });\r\n        } catch (err) {\r\n            console.error(`Failed to add new payment. ${err}`);\r\n            setErrorMessage(err.message);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <Form className=\"container-fluid\" handleSubmit={handleSubmit}>\r\n            {(errorMessage) &&\r\n                <FormRow className=\"justify-content-center\">\r\n                    <div className=\"alert alert-danger\" role=\"alert\">{errorMessage}</div>\r\n                </FormRow>\r\n            }\r\n            <FormRow className=\"my-2\">\r\n                <FormLabel for=\"paymentWidget1\" className=\"col-sm-4\">Amount</FormLabel>\r\n                <FormGroup className=\"col-sm-8\">\r\n                    <input id=\"paymentWidget1\" type=\"number\" name=\"amount\" \r\n                        className=\"form-control\" value={fields.amount} onChange={handleChange} \r\n                            placeholder=\"Add payment amount\" min=\"0\" step=\"0.01\">\r\n                    </input>\r\n                </FormGroup>\r\n            </FormRow>\r\n            <FormRow className=\"my-2 justify-content-center\">\r\n                <FormSubmit className=\"col-auto col-md-4\">Pay</FormSubmit>\r\n            </FormRow>\r\n        </Form>\r\n    );\r\n}","import React from 'react';\r\nimport { Col, DescriptionDetails, DescriptionList, \r\n    DescriptionTerm, \r\n    Row} from '../../../../../../components/layout';\r\nimport { Currency } from '../../../../../../components/users';\r\n\r\n\r\nexport default function InfoSection(props) {\r\n    return (\r\n        <DescriptionList>\r\n            <Col className=\"col-12 col-md-6\">\r\n                <Row>\r\n                    <DescriptionTerm className=\"col-12 col-md-auto\">Service Charge</DescriptionTerm>\r\n                    <DescriptionDetails className=\"col-12 col-md\">\r\n                        <Currency value={props.appointment.serviceCharge} />\r\n                    </DescriptionDetails>\r\n                </Row>\r\n            </Col>\r\n            <Col className=\"col-12 col-md-6\">\r\n                <Row>\r\n                    <DescriptionTerm className=\"col-12 col-md-auto\">Payment Balance</DescriptionTerm>\r\n                    <DescriptionDetails className=\"col-12 col-md\">\r\n                        <Currency value={props.appointment.paymentBalance} />\r\n                    </DescriptionDetails>\r\n                </Row>\r\n            </Col>\r\n        </DescriptionList>\r\n    );\r\n}","import React from 'react';\r\nimport { NumericDate } from '../../../../../../components/dates';\r\nimport { Col, FluidContainer, Row } from '../../../../../../components/layout';\r\nimport { Currency } from '../../../../../../components/users';\r\nimport { WidgetList, WidgetListItem, } from '../../../../../../components/widgets';\r\n\r\n\r\nfunction DefaultPaymentItem(props) {\r\n    return (\r\n        <WidgetListItem>\r\n            <FluidContainer>\r\n                <Row>\r\n                    <Col className=\"md-font-sm text-center text-muted\">No payment available</Col>\r\n                </Row>\r\n            </FluidContainer>\r\n        </WidgetListItem>\r\n    );\r\n}\r\n\r\n\r\nfunction PaymentItem(props) {\r\n    const date = new Date(props.payment.date);\r\n    return (\r\n        <WidgetListItem>\r\n            <FluidContainer>\r\n                <Row>\r\n                    <Col className=\"align-self-center\">\r\n                        <Row>\r\n                            <Col className=\"text-truncate\">\r\n                                <Currency value={props.payment.amount} />\r\n                            </Col>\r\n                            <Col className=\"col-auto\">\r\n                                <NumericDate date={date} />\r\n                            </Col>\r\n                        </Row>\r\n                    </Col>\r\n                </Row>\r\n            </FluidContainer>\r\n        </WidgetListItem>\r\n    );\r\n}\r\n\r\n\r\nexport default function ListSection(props) {\r\n    return (\r\n        <WidgetList>\r\n            {(props.payments.length !== 0) ?\r\n                <>\r\n                    {props.payments.map((payment, index) => (\r\n                        <PaymentItem \r\n                            key={index}\r\n                            session={props.session}\r\n                            payment={payment}\r\n                            handleDelete={props.deletePayment}\r\n                        />\r\n                    ))}\r\n                </> :\r\n                <DefaultPaymentItem />\r\n            }\r\n        </WidgetList>\r\n    );\r\n}","import React, { useState } from 'react';\r\nimport { useCompareUsers } from '../../../../../../components/hooks';\r\nimport { AutoLoader } from '../../../../../../components/loaders';\r\nimport { TitleBar, TitleToggler, Widget, WidgetBody, \r\n    WidgetCollapsible } from '../../../../../../components/widgets';\r\n\r\nimport AddSection from './addSection';\r\nimport InfoSection from './infoSection';\r\nimport ListSection from './listSection';\r\n\r\n\r\nexport default function PaymentSection(props) {\r\n    const [state, setState] = useState({\r\n        payments: [],\r\n        limit: 10\r\n    });\r\n    \r\n    async function appendPayments() {\r\n        try {\r\n            const url = `/api/appointments/${props.appointment.id}/payments`;\r\n\r\n            const searchParams = new URLSearchParams();\r\n            searchParams.append('page', Math.ceil(state.payments.length / state.limit));\r\n            searchParams.append('limit', state.limit);\r\n            \r\n            const response = await fetch(`${url}?${searchParams.toString()}`, {\r\n                headers: {\r\n                    'Authorization': `Bearer ${props.session.authToken}`\r\n                }\r\n            });\r\n\r\n            let newPayments = await response.json();\r\n            if (!response.ok) {\r\n                throw new Error(newPayments.message);\r\n            }\r\n\r\n            setState(prevState => {\r\n                const updatedPayments = [...prevState.payments, ...newPayments];\r\n\r\n                return {\r\n                    ...prevState,\r\n                    payments: updatedPayments\r\n                }\r\n            })\r\n        } catch (err) {\r\n            console.error(`Failed to append more payments. ${err}`);\r\n        }\r\n    }\r\n\r\n    async function appendPayment(newPayment) {\r\n        setState(prevState => {\r\n            const newPayments = [newPayment, ...prevState.payments];\r\n\r\n            return {\r\n                ...prevState,\r\n                payments: newPayments\r\n            }\r\n        });\r\n\r\n        if (props.updatePayment) {\r\n            const newPaymentBalance = props.appointment.paymentBalance - newPayment.amount;\r\n            props.updatePayment(newPaymentBalance);\r\n        }\r\n    }\r\n\r\n    async function deletePayment(id) {\r\n        try {\r\n            const response = await fetch(`/api/appointments/${props.appointment.id}/payments/${id}`, {\r\n                method: 'DELETE',\r\n                credentials: 'same-origin',\r\n                headers: {\r\n                  'Content-Type': 'application/json',\r\n                  'Authorization': `Bearer ${props.session.authToken}`\r\n                }\r\n            });\r\n\r\n            let data = await response.json();\r\n            if (!response.ok) {\r\n                throw new Error(data.message);\r\n            }\r\n\r\n            let deletedPayment = null;\r\n            setState(prevState => {\r\n                const newPayments = state.payments.filter(payment => {\r\n                    if (payment.id == id) {\r\n                        Object.assign(payment, deletedPayment);\r\n                    }\r\n                    return payment.id !== id;\r\n                });\r\n\r\n                return {\r\n                    ...prevState,\r\n                    payments: newPayments\r\n                }\r\n            });\r\n\r\n            if (props.updatePayment && deletedPayment !== null) {\r\n                const newPaymentBalance = props.appointment.paymentBalance + deletedPayment.amount;\r\n                props.updatePayment(newPaymentBalance);\r\n            }\r\n        } catch (err) {\r\n            console.error(`Failed to delete payment- ${id}. ${err}`);\r\n        }\r\n    }\r\n\r\n\r\n    // Now render view\r\n    const isCurrentUserPatient = useCompareUsers(props.session, props.appointment.patient);\r\n\r\n    return (\r\n        <>\r\n            <Widget>\r\n                <TitleBar title=\"Payments\">\r\n                    {isCurrentUserPatient &&\r\n                        <TitleToggler \r\n                            target=\"apptPaymentAdd01\"\r\n                            expandIcon=\"add\"\r\n                            collapseIcon=\"clear\"\r\n                        />\r\n                    }\r\n                </TitleBar>\r\n                <WidgetBody className=\"border-bottom\">\r\n                    <InfoSection\r\n                        appointment={props.appointment}\r\n                    />\r\n                </WidgetBody>\r\n                <WidgetCollapsible id=\"apptPaymentAdd01\">\r\n                    <AddSection \r\n                        session={props.session}\r\n                        appointment={props.appointment}\r\n                        appendPayment={appendPayment}\r\n                    />\r\n                </WidgetCollapsible>\r\n                <ListSection\r\n                    session={props.session}\r\n                    payments={state.payments}\r\n                    deletePayment={deletePayment}\r\n                />\r\n            </Widget>\r\n            <AutoLoader callback={appendPayments} />\r\n        </>\r\n    );\r\n}","import arrayWithoutHoles from \"@babel/runtime/helpers/esm/arrayWithoutHoles\";\nimport iterableToArray from \"@babel/runtime/helpers/esm/iterableToArray\";\nimport unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nimport nonIterableSpread from \"@babel/runtime/helpers/esm/nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"@babel/runtime/helpers/esm/arrayLikeToArray\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}"],"sourceRoot":""}